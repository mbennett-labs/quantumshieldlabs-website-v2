<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quantum Risk Calculator - Quantum Shield Labs</title>
    <meta name="description" content="Assess your organization's quantum security risk with our comprehensive calculator.">

    <!-- Tailwind CSS CDN -->
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">

    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">

    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@3.9.1/dist/chart.min.js"></script>

    <!-- jsPDF -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

    <style>
        * {
            font-family: 'Inter', sans-serif;
        }

        body {
            background: linear-gradient(to bottom, #0f172a, #000);
            min-height: 100vh;
            color: white;
        }

        .gradient-text {
            background: linear-gradient(to right, #3b82f6, #8b5cf6);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .card {
            background: rgba(17, 24, 39, 0.3);
            backdrop-filter: blur(16px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .btn-primary {
            background: #3b82f6;
            transition: all 0.3s ease;
        }

        .btn-primary:hover {
            background: #2563eb;
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(59, 130, 246, 0.3);
        }

        .fade-in {
            animation: fadeIn 0.5s ease-in;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .progress-bar {
            transition: width 0.5s ease;
        }

        .question-option {
            cursor: pointer;
            transition: all 0.3s ease;
            background: rgba(30, 41, 59, 0.3);
            backdrop-filter: blur(10px);
            border: 2px solid transparent;
        }

        .question-option:hover {
            border-color: #3b82f6;
            background: rgba(59, 130, 246, 0.1);
        }

        .question-option.selected {
            border-color: #3b82f6;
            background: rgba(59, 130, 246, 0.2);
        }

        .risk-low { color: #10b981; }
        .risk-moderate { color: #f59e0b; }
        .risk-high { color: #f97316; }
        .risk-critical { color: #ef4444; }

        .hidden { display: none; }

        .spinner {
            border: 3px solid rgba(255, 255, 255, 0.1);
            border-top-color: #3b82f6;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .hamburger {
            display: none;
        }

        @media (max-width: 768px) {
            .nav-links {
                display: none;
            }

            .hamburger {
                display: block;
            }

            .mobile-menu {
                position: fixed;
                top: 64px;
                left: 0;
                right: 0;
                background: rgba(0, 0, 0, 0.95);
                backdrop-filter: blur(16px);
                padding: 1rem;
                display: none;
            }

            .mobile-menu.active {
                display: block;
            }
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav class="fixed w-full z-50 py-4 px-6 bg-black/80 backdrop-blur-lg">
        <div class="container mx-auto flex justify-between items-center">
            <a href="/" class="flex items-center space-x-2">
                <i class="fas fa-shield-alt text-blue-500 text-2xl"></i>
                <span class="text-xl font-bold">Quantum Shield Labs</span>
            </a>
            <div class="nav-links hidden md:flex space-x-8">
                <a href="/#services" class="hover:text-blue-400 transition">Services</a>
                <a href="/#projects" class="hover:text-blue-400 transition">Projects</a>
                <a href="/#about" class="hover:text-blue-400 transition">About</a>
                <a href="/#contact" class="hover:text-blue-400 transition">Contact</a>
            </div>
            <button class="hamburger text-2xl" onclick="toggleMobileMenu()">
                <i class="fas fa-bars"></i>
            </button>
        </div>
        <div class="mobile-menu" id="mobileMenu">
            <a href="/#services" class="block py-2 hover:text-blue-400">Services</a>
            <a href="/#projects" class="block py-2 hover:text-blue-400">Projects</a>
            <a href="/#about" class="block py-2 hover:text-blue-400">About</a>
            <a href="/#contact" class="block py-2 hover:text-blue-400">Contact</a>
        </div>
    </nav>

    <!-- Main Container -->
    <div class="container mx-auto px-4 pt-24 pb-12">

        <!-- Landing View -->
        <div id="landingView" class="max-w-4xl mx-auto text-center fade-in">
            <div class="mb-8">
                <i class="fas fa-shield-alt text-blue-500 text-6xl mb-4"></i>
                <h1 class="text-4xl md:text-5xl font-bold mb-4 gradient-text">Quantum Security Risk Assessment</h1>
                <p class="text-gray-300 text-lg md:text-xl max-w-2xl mx-auto">
                    Discover your organization's vulnerability to quantum computing threats in just 8 questions.
                    Get a comprehensive risk score and actionable recommendations.
                </p>
            </div>

            <div class="card rounded-2xl p-8 md:p-12 my-8">
                <h2 class="text-2xl font-bold mb-4">What You'll Learn</h2>
                <div class="grid md:grid-cols-3 gap-6 text-left">
                    <div>
                        <i class="fas fa-gauge-high text-blue-500 text-3xl mb-2"></i>
                        <h3 class="font-semibold mb-1">Your Risk Score</h3>
                        <p class="text-gray-400 text-sm">Precise assessment of quantum vulnerability</p>
                    </div>
                    <div>
                        <i class="fas fa-exclamation-triangle text-purple-500 text-3xl mb-2"></i>
                        <h3 class="font-semibold mb-1">Key Vulnerabilities</h3>
                        <p class="text-gray-400 text-sm">Top 3 critical security gaps identified</p>
                    </div>
                    <div>
                        <i class="fas fa-road text-blue-500 text-3xl mb-2"></i>
                        <h3 class="font-semibold mb-1">Action Plan</h3>
                        <p class="text-gray-400 text-sm">Clear timeline for remediation steps</p>
                    </div>
                </div>
            </div>

            <button onclick="startAssessment()" class="btn-primary text-white px-8 py-4 rounded-lg text-lg font-semibold">
                <i class="fas fa-play-circle mr-2"></i>Start Assessment
            </button>
            <p class="text-gray-400 text-sm mt-4">Takes 3-5 minutes • Free detailed PDF report</p>
        </div>

        <!-- Question View -->
        <div id="questionView" class="max-w-3xl mx-auto hidden">
            <!-- Progress Bar -->
            <div class="mb-8">
                <div class="flex justify-between items-center mb-2">
                    <span class="text-sm font-semibold text-gray-400">Progress</span>
                    <span id="progressText" class="text-sm font-semibold text-blue-400">Question 1 of 8</span>
                </div>
                <div class="w-full bg-gray-800 rounded-full h-2">
                    <div id="progressBar" class="progress-bar bg-gradient-to-r from-blue-500 to-purple-500 h-2 rounded-full" style="width: 12.5%"></div>
                </div>
            </div>

            <!-- Question Card -->
            <div class="card rounded-2xl p-8 md:p-12 fade-in">
                <h2 id="questionTitle" class="text-2xl md:text-3xl font-bold mb-6"></h2>
                <div id="questionOptions" class="space-y-4"></div>

                <div class="flex justify-between mt-8">
                    <button id="backBtn" onclick="previousQuestion()" class="text-gray-400 hover:text-white transition">
                        <i class="fas fa-arrow-left mr-2"></i>Back
                    </button>
                    <button id="nextBtn" onclick="nextQuestion()" class="btn-primary text-white px-6 py-3 rounded-lg font-semibold opacity-50 cursor-not-allowed" disabled>
                        Next<i class="fas fa-arrow-right ml-2"></i>
                    </button>
                </div>
            </div>
        </div>

        <!-- Processing View -->
        <div id="processingView" class="max-w-2xl mx-auto text-center hidden">
            <div class="card rounded-2xl p-12">
                <div class="spinner mx-auto mb-4"></div>
                <h2 class="text-2xl font-bold mb-2">Analyzing Your Responses...</h2>
                <p class="text-gray-400">Calculating your quantum risk profile</p>
            </div>
        </div>

        <!-- Results View -->
        <div id="resultsView" class="max-w-4xl mx-auto hidden">
            <div class="text-center mb-8">
                <h1 class="text-3xl md:text-4xl font-bold mb-2 gradient-text">Your Quantum Risk Assessment</h1>
                <p class="text-gray-300">Based on your organization's profile</p>
            </div>

            <!-- Risk Score Gauge -->
            <div class="card rounded-2xl p-8 md:p-12 mb-6">
                <div class="grid md:grid-cols-2 gap-8 items-center">
                    <div>
                        <canvas id="riskGauge" width="300" height="300"></canvas>
                    </div>
                    <div>
                        <div id="riskBadge" class="inline-block px-4 py-2 rounded-full font-bold mb-4"></div>
                        <h2 id="riskLevel" class="text-3xl font-bold mb-4"></h2>
                        <p id="riskMessage" class="text-gray-300 mb-4"></p>
                        <div class="bg-gray-800/50 rounded-lg p-4">
                            <p class="text-sm font-semibold text-gray-400 mb-1">Recommended Timeline</p>
                            <p id="riskTimeline" class="font-semibold"></p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Vulnerabilities -->
            <div class="card rounded-2xl p-8 md:p-12 mb-6">
                <h2 class="text-2xl font-bold mb-6">
                    <i class="fas fa-exclamation-triangle text-orange-500 mr-2"></i>
                    Top Vulnerabilities Identified
                </h2>
                <div id="vulnerabilitiesList" class="space-y-4"></div>
            </div>

            <!-- Email Capture Form -->
            <div class="card rounded-2xl p-8 md:p-12">
                <div class="text-center mb-6">
                    <i class="fas fa-file-pdf text-red-500 text-4xl mb-3"></i>
                    <h2 class="text-2xl font-bold mb-2">Get Your Detailed PDF Report</h2>
                    <p class="text-gray-300">Enter your information to receive a comprehensive analysis and action plan</p>
                </div>

                <form id="emailForm" class="max-w-lg mx-auto">
                    <div class="grid md:grid-cols-2 gap-4 mb-4">
                        <input type="text" name="name" placeholder="Full Name *" required
                               class="bg-gray-800 border border-gray-700 rounded-lg px-4 py-3 focus:outline-none focus:border-blue-500">
                        <input type="email" name="email" placeholder="Email Address *" required
                               class="bg-gray-800 border border-gray-700 rounded-lg px-4 py-3 focus:outline-none focus:border-blue-500">
                    </div>
                    <div class="grid md:grid-cols-2 gap-4 mb-4">
                        <input type="text" name="company" placeholder="Company Name *" required
                               class="bg-gray-800 border border-gray-700 rounded-lg px-4 py-3 focus:outline-none focus:border-blue-500">
                        <input type="tel" name="phone" placeholder="Phone (Optional)"
                               class="bg-gray-800 border border-gray-700 rounded-lg px-4 py-3 focus:outline-none focus:border-blue-500">
                    </div>

                    <!-- Hidden fields for assessment data -->
                    <input type="hidden" name="risk_score" id="formRiskScore">
                    <input type="hidden" name="risk_level" id="formRiskLevel">
                    <input type="hidden" name="assessment_data" id="formAssessmentData">

                    <button type="submit" class="btn-primary w-full text-white px-8 py-4 rounded-lg text-lg font-semibold">
                        <i class="fas fa-download mr-2"></i>Download PDF Report
                    </button>
                    <p class="text-gray-400 text-sm text-center mt-3">
                        We respect your privacy. Your information is never shared.
                    </p>
                </form>

                <div id="formSuccess" class="hidden text-center">
                    <i class="fas fa-check-circle text-green-500 text-5xl mb-4"></i>
                    <h3 class="text-2xl font-bold mb-2">Download Starting...</h3>
                    <p class="text-gray-300 mb-4">Your PDF report is being generated</p>
                    <a href="/#contact" class="text-blue-400 hover:text-blue-300">
                        Schedule a consultation <i class="fas fa-arrow-right ml-1"></i>
                    </a>
                </div>

                <div id="formError" class="hidden text-center text-red-500">
                    <i class="fas fa-exclamation-circle text-4xl mb-2"></i>
                    <p>Unable to submit form. Please try again or contact us directly.</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Assessment Configuration
        const questions = [
            {
                id: 1,
                title: "Which cryptographic protocols does your organization currently use?",
                options: [
                    { text: "RSA", points: 15 },
                    { text: "ECC (Elliptic Curve Cryptography)", points: 12 },
                    { text: "AES", points: 5 },
                    { text: "Multiple/Unsure", points: 10 }
                ]
            },
            {
                id: 2,
                title: "Where is encryption primarily deployed?",
                options: [
                    { text: "Data at rest", points: 8 },
                    { text: "In transit", points: 8 },
                    { text: "Both", points: 5 },
                    { text: "Unsure", points: 15 }
                ]
            },
            {
                id: 3,
                title: "Do you maintain encrypted data for longer than 5 years?",
                options: [
                    { text: "Yes", points: 20 },
                    { text: "No", points: 5 },
                    { text: "Unsure", points: 10 }
                ]
            },
            {
                id: 4,
                title: "Which regulations apply to your organization?",
                options: [
                    { text: "HIPAA", points: 10 },
                    { text: "HITECH", points: 10 },
                    { text: "Both", points: 15 },
                    { text: "Other", points: 8 },
                    { text: "None", points: 5 }
                ]
            },
            {
                id: 5,
                title: "What type of sensitive data do you handle?",
                options: [
                    { text: "PHI (Protected Health Information)", points: 12 },
                    { text: "Financial", points: 10 },
                    { text: "Both", points: 15 },
                    { text: "Other", points: 8 }
                ]
            },
            {
                id: 6,
                title: "When was your last cryptographic security audit?",
                options: [
                    { text: "Less than 1 year ago", points: 5 },
                    { text: "1-3 years ago", points: 8 },
                    { text: "3+ years ago", points: 15 },
                    { text: "Never", points: 20 }
                ]
            },
            {
                id: 7,
                title: "How quickly could you migrate to new encryption standards if required?",
                options: [
                    { text: "Less than 6 months", points: 5 },
                    { text: "6-12 months", points: 8 },
                    { text: "1-2 years", points: 12 },
                    { text: "Unsure", points: 15 }
                ]
            },
            {
                id: 8,
                title: "What's your organization size?",
                options: [
                    { text: "1-50 employees", points: 5 },
                    { text: "51-200 employees", points: 8 },
                    { text: "201-1000 employees", points: 12 },
                    { text: "1000+ employees", points: 15 }
                ]
            }
        ];

        // Vulnerability definitions
        const vulnerabilityMap = [
            {
                condition: (answers) => answers[2] === "Yes",
                priority: 1,
                text: "Long-term data storage vulnerable to 'harvest now, decrypt later' quantum attacks"
            },
            {
                condition: (answers) => answers[5] === "Never",
                priority: 2,
                text: "No cryptographic security audits create dangerous blind spots to quantum threats"
            },
            {
                condition: (answers) => answers[0] === "RSA",
                priority: 3,
                text: "RSA encryption will be broken by quantum computers within 5-10 years"
            },
            {
                condition: (answers) => answers[1] === "Unsure",
                priority: 4,
                text: "Unknown encryption deployment points create exploitable vulnerabilities"
            },
            {
                condition: (answers) => answers[6] === "Unsure",
                priority: 5,
                text: "Inability to quickly migrate to quantum-resistant algorithms extends exposure window"
            },
            {
                condition: (answers) => answers[7] === "1000+ employees",
                priority: 6,
                text: "Enterprise scale amplifies potential impact of quantum cryptographic breaks"
            },
            {
                condition: (answers) => answers[3] === "Both",
                priority: 7,
                text: "Dual regulatory requirements (HIPAA/HITECH) face quantum compliance gaps"
            },
            {
                condition: (answers) => answers[4] === "Both",
                priority: 8,
                text: "Combined PHI and financial data creates high-value quantum attack target"
            }
        ];

        // State
        let currentQuestion = 0;
        let answers = [];
        let selectedAnswers = []; // Store answer text
        let totalScore = 0;

        // Functions
        function toggleMobileMenu() {
            document.getElementById('mobileMenu').classList.toggle('active');
        }

        function startAssessment() {
            console.log('Assessment started');
            document.getElementById('landingView').classList.add('hidden');
            document.getElementById('questionView').classList.remove('hidden');
            displayQuestion();
        }

        function displayQuestion() {
            const question = questions[currentQuestion];
            document.getElementById('questionTitle').textContent = question.title;
            document.getElementById('progressText').textContent = `Question ${currentQuestion + 1} of 8`;
            document.getElementById('progressBar').style.width = `${((currentQuestion + 1) / 8) * 100}%`;

            const optionsContainer = document.getElementById('questionOptions');
            optionsContainer.innerHTML = '';

            question.options.forEach((option, index) => {
                const optionDiv = document.createElement('div');
                optionDiv.className = `question-option p-4 rounded-lg ${answers[currentQuestion] === option.text ? 'selected' : ''}`;
                optionDiv.innerHTML = `
                    <div class="flex items-center">
                        <div class="w-6 h-6 rounded-full border-2 mr-3 flex items-center justify-center ${answers[currentQuestion] === option.text ? 'border-blue-500 bg-blue-500' : 'border-gray-600'}">
                            ${answers[currentQuestion] === option.text ? '<i class="fas fa-check text-white text-xs"></i>' : ''}
                        </div>
                        <span>${option.text}</span>
                    </div>
                `;
                optionDiv.onclick = () => selectOption(option.text, option.points);
                optionsContainer.appendChild(optionDiv);
            });

            // Update back button
            document.getElementById('backBtn').style.visibility = currentQuestion === 0 ? 'hidden' : 'visible';

            // Update next button
            updateNextButton();
        }

        function selectOption(answerText, points) {
            answers[currentQuestion] = answerText;
            selectedAnswers[currentQuestion] = {
                question: questions[currentQuestion].title,
                answer: answerText,
                points: points
            };
            displayQuestion();
        }

        function updateNextButton() {
            const nextBtn = document.getElementById('nextBtn');
            if (answers[currentQuestion]) {
                nextBtn.disabled = false;
                nextBtn.classList.remove('opacity-50', 'cursor-not-allowed');
            } else {
                nextBtn.disabled = true;
                nextBtn.classList.add('opacity-50', 'cursor-not-allowed');
            }
        }

        function nextQuestion() {
            if (!answers[currentQuestion]) return;

            if (currentQuestion < questions.length - 1) {
                currentQuestion++;
                displayQuestion();
            } else {
                calculateResults();
            }
        }

        function previousQuestion() {
            if (currentQuestion > 0) {
                currentQuestion--;
                displayQuestion();
            }
        }

        function calculateResults() {
            console.log('Calculating results');

            // Show processing view
            document.getElementById('questionView').classList.add('hidden');
            document.getElementById('processingView').classList.remove('hidden');

            // Calculate total score
            totalScore = selectedAnswers.reduce((sum, item) => sum + item.points, 0);
            console.log('Total Score:', totalScore);

            // Simulate processing time
            setTimeout(() => {
                displayResults();
            }, 2000);
        }

        function displayResults() {
            document.getElementById('processingView').classList.add('hidden');
            document.getElementById('resultsView').classList.remove('hidden');

            // Determine risk level
            let riskLevel, riskColor, riskIcon, riskMessage, riskTimeline, riskBadgeText;

            if (totalScore <= 25) {
                riskLevel = 'LOW RISK';
                riskColor = '#10b981';
                riskIcon = 'fa-shield-alt';
                riskMessage = 'Your quantum security posture is currently strong, but monitoring is recommended';
                riskTimeline = 'Review annually';
                riskBadgeText = 'Low Risk';
            } else if (totalScore <= 50) {
                riskLevel = 'MODERATE RISK';
                riskColor = '#f59e0b';
                riskIcon = 'fa-shield-alt';
                riskMessage = 'Several vulnerabilities detected. Migration planning should begin within 12 months';
                riskTimeline = 'Action recommended within 12 months';
                riskBadgeText = 'Moderate Risk';
            } else if (totalScore <= 75) {
                riskLevel = 'HIGH RISK';
                riskColor = '#f97316';
                riskIcon = 'fa-exclamation-triangle';
                riskMessage = 'Significant exposure to quantum threats. Immediate assessment recommended';
                riskTimeline = 'Urgent assessment needed within 3-6 months';
                riskBadgeText = 'High Risk';
            } else {
                riskLevel = 'CRITICAL RISK';
                riskColor = '#ef4444';
                riskIcon = 'fa-times-circle';
                riskMessage = 'Your encrypted data faces serious quantum vulnerability. Urgent action required';
                riskTimeline = 'Immediate action required';
                riskBadgeText = 'Critical Risk';
            }

            // Update UI
            const riskBadge = document.getElementById('riskBadge');
            riskBadge.textContent = riskBadgeText;
            riskBadge.style.backgroundColor = riskColor + '33';
            riskBadge.style.color = riskColor;

            document.getElementById('riskLevel').textContent = riskLevel;
            document.getElementById('riskLevel').style.color = riskColor;
            document.getElementById('riskMessage').textContent = riskMessage;
            document.getElementById('riskTimeline').textContent = riskTimeline;

            // Create gauge chart
            createGaugeChart(totalScore, riskColor);

            // Display vulnerabilities
            displayVulnerabilities();

            // Prepare form data
            document.getElementById('formRiskScore').value = totalScore;
            document.getElementById('formRiskLevel').value = riskLevel;
            document.getElementById('formAssessmentData').value = JSON.stringify(selectedAnswers);
        }

        function createGaugeChart(score, color) {
            const ctx = document.getElementById('riskGauge').getContext('2d');

            new Chart(ctx, {
                type: 'doughnut',
                data: {
                    datasets: [{
                        data: [score, 100 - score],
                        backgroundColor: [color, 'rgba(255, 255, 255, 0.1)'],
                        borderWidth: 0
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: true,
                    cutout: '75%',
                    plugins: {
                        legend: { display: false },
                        tooltip: { enabled: false }
                    },
                    animation: {
                        animateRotate: true,
                        animateScale: true
                    }
                },
                plugins: [{
                    id: 'centerText',
                    beforeDraw: (chart) => {
                        const { width, height, ctx } = chart;
                        ctx.restore();
                        const fontSize = (height / 114).toFixed(2);
                        ctx.font = `bold ${fontSize}em Inter`;
                        ctx.textBaseline = 'middle';
                        ctx.fillStyle = color;
                        const text = score.toString();
                        const textX = Math.round((width - ctx.measureText(text).width) / 2);
                        const textY = height / 2 - 10;
                        ctx.fillText(text, textX, textY);

                        ctx.font = `${fontSize * 0.4}em Inter`;
                        ctx.fillStyle = '#9ca3af';
                        const subtext = 'out of 100';
                        const subtextX = Math.round((width - ctx.measureText(subtext).width) / 2);
                        const subtextY = height / 2 + 20;
                        ctx.fillText(subtext, subtextX, subtextY);
                        ctx.save();
                    }
                }]
            });
        }

        function displayVulnerabilities() {
            const vulnerabilities = vulnerabilityMap
                .filter(v => v.condition(answers))
                .sort((a, b) => a.priority - b.priority)
                .slice(0, 3);

            const container = document.getElementById('vulnerabilitiesList');
            container.innerHTML = '';

            if (vulnerabilities.length === 0) {
                container.innerHTML = '<p class="text-gray-400">No major vulnerabilities detected based on your responses.</p>';
                return;
            }

            vulnerabilities.forEach((vuln, index) => {
                const vulnDiv = document.createElement('div');
                vulnDiv.className = 'flex items-start bg-gray-800/50 rounded-lg p-4';
                vulnDiv.innerHTML = `
                    <div class="flex-shrink-0 w-8 h-8 rounded-full bg-orange-500/20 flex items-center justify-center mr-3">
                        <span class="text-orange-500 font-bold">${index + 1}</span>
                    </div>
                    <p class="text-gray-300">${vuln.text}</p>
                `;
                container.appendChild(vulnDiv);
            });
        }

        // Form submission
        document.getElementById('emailForm').addEventListener('submit', async (e) => {
            e.preventDefault();

            const formData = new FormData(e.target);
            const data = Object.fromEntries(formData);

            console.log('Submitting form:', data);

            try {
                const response = await fetch('https://formspree.io/f/mgvrkooo', {
                    method: 'POST',
                    body: formData,
                    headers: {
                        'Accept': 'application/json'
                    }
                });

                if (response.ok) {
                    console.log('Form submitted successfully');
                    document.getElementById('emailForm').classList.add('hidden');
                    document.getElementById('formSuccess').classList.remove('hidden');

                    // Generate and download PDF
                    setTimeout(() => {
                        generatePDF(data);
                    }, 500);
                } else {
                    throw new Error('Form submission failed');
                }
            } catch (error) {
                console.error('Form submission error:', error);
                document.getElementById('formError').classList.remove('hidden');
            }
        });

        function generatePDF(userData) {
            console.log('Generating PDF');

            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();

            // Determine risk level details
            let riskLevel, riskColor, riskMessage, riskTimeline;

            if (totalScore <= 25) {
                riskLevel = 'LOW RISK';
                riskColor = [16, 185, 129];
                riskMessage = 'Your quantum security posture is currently strong, but monitoring is recommended.';
                riskTimeline = 'Review annually';
            } else if (totalScore <= 50) {
                riskLevel = 'MODERATE RISK';
                riskColor = [245, 158, 11];
                riskMessage = 'Several vulnerabilities detected. Migration planning should begin within 12 months.';
                riskTimeline = 'Action recommended within 12 months';
            } else if (totalScore <= 75) {
                riskLevel = 'HIGH RISK';
                riskColor = [249, 115, 22];
                riskMessage = 'Significant exposure to quantum threats. Immediate assessment recommended.';
                riskTimeline = 'Urgent assessment needed within 3-6 months';
            } else {
                riskLevel = 'CRITICAL RISK';
                riskColor = [239, 68, 68];
                riskMessage = 'Your encrypted data faces serious quantum vulnerability. Urgent action required.';
                riskTimeline = 'Immediate action required';
            }

            // Page 1: Cover and Results
            doc.setFillColor(15, 23, 42);
            doc.rect(0, 0, 210, 297, 'F');

            // Header
            doc.setTextColor(59, 130, 246);
            doc.setFontSize(24);
            doc.setFont('helvetica', 'bold');
            doc.text('QUANTUM SHIELD LABS', 105, 30, { align: 'center' });

            doc.setTextColor(200, 200, 200);
            doc.setFontSize(12);
            doc.setFont('helvetica', 'normal');
            doc.text('Advanced Security Solutions for the Quantum Age', 105, 40, { align: 'center' });

            // Title
            doc.setTextColor(255, 255, 255);
            doc.setFontSize(28);
            doc.setFont('helvetica', 'bold');
            doc.text('Quantum Security Risk', 105, 70, { align: 'center' });
            doc.text('Assessment Report', 105, 82, { align: 'center' });

            // Date
            doc.setFontSize(10);
            doc.setFont('helvetica', 'normal');
            doc.setTextColor(150, 150, 150);
            const today = new Date().toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' });
            doc.text(`Generated: ${today}`, 105, 95, { align: 'center' });
            doc.text(`Prepared for: ${userData.company}`, 105, 102, { align: 'center' });

            // Risk Score Box
            doc.setFillColor(riskColor[0], riskColor[1], riskColor[2]);
            doc.roundedRect(60, 120, 90, 50, 3, 3, 'F');

            doc.setTextColor(255, 255, 255);
            doc.setFontSize(48);
            doc.setFont('helvetica', 'bold');
            doc.text(totalScore.toString(), 105, 145, { align: 'center' });

            doc.setFontSize(12);
            doc.text('RISK SCORE', 105, 156, { align: 'center' });

            doc.setFontSize(16);
            doc.text(riskLevel, 105, 165, { align: 'center' });

            // Risk Message
            doc.setFontSize(11);
            doc.setTextColor(200, 200, 200);
            const splitMessage = doc.splitTextToSize(riskMessage, 160);
            doc.text(splitMessage, 105, 185, { align: 'center' });

            // Timeline
            doc.setFontSize(10);
            doc.setTextColor(150, 150, 150);
            doc.text('Recommended Timeline:', 20, 210);
            doc.setTextColor(riskColor[0], riskColor[1], riskColor[2]);
            doc.setFont('helvetica', 'bold');
            doc.text(riskTimeline, 20, 218);

            // Page 2: Assessment Details
            doc.addPage();
            doc.setFillColor(15, 23, 42);
            doc.rect(0, 0, 210, 297, 'F');

            // Section: Your Responses
            doc.setTextColor(59, 130, 246);
            doc.setFontSize(16);
            doc.setFont('helvetica', 'bold');
            doc.text('Your Organization\'s Profile', 20, 25);

            doc.setTextColor(255, 255, 255);
            doc.setFontSize(10);
            doc.setFont('helvetica', 'normal');

            let yPos = 35;
            selectedAnswers.forEach((item, index) => {
                if (yPos > 270) {
                    doc.addPage();
                    doc.setFillColor(15, 23, 42);
                    doc.rect(0, 0, 210, 297, 'F');
                    yPos = 20;
                }

                doc.setTextColor(150, 150, 150);
                doc.setFont('helvetica', 'bold');
                const questionText = doc.splitTextToSize(`Q${index + 1}: ${item.question}`, 170);
                doc.text(questionText, 20, yPos);
                yPos += questionText.length * 5;

                doc.setTextColor(59, 130, 246);
                doc.setFont('helvetica', 'normal');
                doc.text(`→ ${item.answer}`, 25, yPos);
                yPos += 10;
            });

            // Vulnerabilities
            yPos += 5;
            if (yPos > 240) {
                doc.addPage();
                doc.setFillColor(15, 23, 42);
                doc.rect(0, 0, 210, 297, 'F');
                yPos = 20;
            }

            doc.setTextColor(249, 115, 22);
            doc.setFontSize(16);
            doc.setFont('helvetica', 'bold');
            doc.text('Identified Vulnerabilities', 20, yPos);
            yPos += 10;

            const vulnerabilities = vulnerabilityMap
                .filter(v => v.condition(answers))
                .sort((a, b) => a.priority - b.priority)
                .slice(0, 3);

            doc.setTextColor(255, 255, 255);
            doc.setFontSize(10);
            doc.setFont('helvetica', 'normal');

            vulnerabilities.forEach((vuln, index) => {
                if (yPos > 270) {
                    doc.addPage();
                    doc.setFillColor(15, 23, 42);
                    doc.rect(0, 0, 210, 297, 'F');
                    yPos = 20;
                }

                doc.setTextColor(249, 115, 22);
                doc.setFont('helvetica', 'bold');
                doc.text(`${index + 1}.`, 20, yPos);

                doc.setTextColor(200, 200, 200);
                doc.setFont('helvetica', 'normal');
                const vulnText = doc.splitTextToSize(vuln.text, 165);
                doc.text(vulnText, 27, yPos);
                yPos += vulnText.length * 5 + 5;
            });

            // Page 3: Next Steps and Contact
            doc.addPage();
            doc.setFillColor(15, 23, 42);
            doc.rect(0, 0, 210, 297, 'F');

            // About Quantum Threats
            doc.setTextColor(59, 130, 246);
            doc.setFontSize(16);
            doc.setFont('helvetica', 'bold');
            doc.text('Understanding Quantum Threats', 20, 25);

            doc.setTextColor(200, 200, 200);
            doc.setFontSize(10);
            doc.setFont('helvetica', 'normal');
            const threatText = doc.splitTextToSize(
                'Quantum computers pose a significant threat to current encryption methods. Experts predict that within 5-10 years, quantum computers will be capable of breaking RSA and ECC encryption, exposing sensitive data encrypted today. Organizations must begin planning their migration to post-quantum cryptography now.',
                170
            );
            doc.text(threatText, 20, 35);

            // Why Act Now
            yPos = 35 + threatText.length * 5 + 10;
            doc.setTextColor(59, 130, 246);
            doc.setFontSize(14);
            doc.setFont('helvetica', 'bold');
            doc.text('Why Act Now', 20, yPos);
            yPos += 8;

            doc.setTextColor(200, 200, 200);
            doc.setFontSize(10);
            doc.setFont('helvetica', 'normal');

            const reasons = [
                'Harvest Now, Decrypt Later: Attackers are collecting encrypted data today to decrypt once quantum computers become available',
                'Compliance Requirements: Regulatory bodies are beginning to mandate quantum-resistant security measures',
                'Migration Complexity: Transitioning to post-quantum cryptography is complex and time-consuming',
                'Competitive Advantage: Early adopters will have stronger security posture and customer trust'
            ];

            reasons.forEach(reason => {
                const reasonText = doc.splitTextToSize(`• ${reason}`, 165);
                doc.text(reasonText, 25, yPos);
                yPos += reasonText.length * 5 + 3;
            });

            // Next Steps
            yPos += 10;
            doc.setTextColor(59, 130, 246);
            doc.setFontSize(14);
            doc.setFont('helvetica', 'bold');
            doc.text('Recommended Next Steps', 20, yPos);
            yPos += 8;

            doc.setTextColor(200, 200, 200);
            doc.setFontSize(10);
            doc.setFont('helvetica', 'normal');

            const steps = [
                '1. Schedule a detailed security assessment with our team',
                '2. Inventory all systems using vulnerable cryptographic protocols',
                '3. Develop a phased migration plan to quantum-resistant algorithms',
                '4. Implement monitoring for quantum computing developments',
                '5. Train your team on post-quantum cryptography best practices'
            ];

            steps.forEach(step => {
                doc.text(step, 20, yPos);
                yPos += 7;
            });

            // Contact Information
            yPos += 15;
            doc.setFillColor(59, 130, 246);
            doc.roundedRect(20, yPos, 170, 50, 3, 3, 'F');

            yPos += 8;
            doc.setTextColor(255, 255, 255);
            doc.setFontSize(14);
            doc.setFont('helvetica', 'bold');
            doc.text('Contact Quantum Shield Labs', 105, yPos, { align: 'center' });

            yPos += 10;
            doc.setFontSize(10);
            doc.setFont('helvetica', 'normal');
            doc.text('Email: michael@quantumshieldlabs.dev', 105, yPos, { align: 'center' });

            yPos += 6;
            doc.text('Phone: (240) 659-8286', 105, yPos, { align: 'center' });

            yPos += 6;
            doc.text('Address: 6814 Westmoreland Ave, Takoma Park, MD 20912', 105, yPos, { align: 'center' });

            yPos += 10;
            doc.setFontSize(9);
            doc.setTextColor(200, 200, 200);
            doc.text('Schedule your consultation at quantumshieldlabs.dev', 105, yPos, { align: 'center' });

            // Footer
            doc.setFontSize(8);
            doc.setTextColor(150, 150, 150);
            doc.text('© 2025 Quantum Shield Labs - Advanced Security Solutions for the Quantum Age', 105, 285, { align: 'center' });

            // Save PDF
            doc.save(`Quantum-Risk-Assessment-${userData.company.replace(/\s+/g, '-')}.pdf`);
            console.log('PDF generated and downloaded');
        }
    </script>
</body>
</html>
