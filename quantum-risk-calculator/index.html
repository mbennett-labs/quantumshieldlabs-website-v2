
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quantum Security Risk Calculator | Quantum Shield Labs</title>
    <meta name="description" content="Assess your organization's quantum security risk in 2 minutes. Get an instant risk score and professional PDF report.">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/tailwindcss/2.2.19/tailwind.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <style>
        :root {
            --primary-blue: #3b82f6;
            --primary-purple: #8b5cf6;
            --dark-bg: #0f172a;
            --darker-bg: #020617;
            --card-bg: rgba(15, 23, 42, 0.8);
            --border-color: rgba(59, 130, 246, 0.3);
            --text-primary: #ffffff;
            --text-secondary: #94a3b8;
            --green: #10b981;
            --yellow: #f59e0b;
            --orange: #f97316;
            --red: #ef4444;
        }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, var(--darker-bg) 0%, var(--dark-bg) 50%, rgba(59, 130, 246, 0.1) 100%);
            color: var(--text-primary);
            min-height: 100vh;
        }
        .bg-pattern {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background-image: radial-gradient(circle at 20% 80%, rgba(59, 130, 246, 0.1) 0%, transparent 50%),
                              radial-gradient(circle at 80% 20%, rgba(139, 92, 246, 0.1) 0%, transparent 50%);
            pointer-events: none; z-index: 0;
        }
        .container { max-width: 800px; margin: 0 auto; padding: 2rem; position: relative; z-index: 1; }
        .header { text-align: center; padding: 2rem 0; }
        .logo { display: flex; align-items: center; justify-content: center; gap: 0.75rem; text-decoration: none; }
        .logo i { font-size: 2rem; color: var(--primary-blue); }
        .logo-text {
            font-size: 1.5rem; font-weight: 700;
            background: linear-gradient(135deg, var(--primary-blue), var(--primary-purple));
            -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;
        }
        .card {
            background: var(--card-bg); backdrop-filter: blur(20px);
            border: 1px solid var(--border-color); border-radius: 1.5rem;
            padding: 2.5rem; box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5);
        }
        .landing-title { font-size: 2.5rem; font-weight: 800; text-align: center; margin-bottom: 1rem; line-height: 1.2; }
        .landing-title span {
            background: linear-gradient(135deg, var(--primary-blue), var(--primary-purple));
            -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;
        }
        .landing-subtitle { text-align: center; color: var(--text-secondary); font-size: 1.125rem; margin-bottom: 2rem; line-height: 1.6; }
        .features-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 1rem; margin-bottom: 2rem; }
        @media (max-width: 640px) { .features-grid { grid-template-columns: 1fr; } .landing-title { font-size: 1.875rem; } }
        .feature-item {
            display: flex; align-items: center; gap: 0.75rem; padding: 1rem;
            background: rgba(59, 130, 246, 0.05); border-radius: 0.75rem; border: 1px solid rgba(59, 130, 246, 0.1);
        }
        .feature-item i { color: var(--green); font-size: 1.25rem; }
        .feature-item span { color: var(--text-secondary); font-size: 0.875rem; }
        .btn-primary {
            display: inline-flex; align-items: center; justify-content: center; gap: 0.5rem;
            width: 100%; padding: 1rem 2rem;
            background: linear-gradient(135deg, var(--primary-blue), var(--primary-purple));
            color: white; font-weight: 600; font-size: 1.125rem; border: none; border-radius: 0.75rem;
            cursor: pointer; transition: all 0.3s ease; box-shadow: 0 10px 40px -10px rgba(59, 130, 246, 0.5);
        }
        .btn-primary:hover { transform: translateY(-2px); box-shadow: 0 15px 50px -10px rgba(59, 130, 246, 0.6); }
        .btn-primary:disabled { opacity: 0.5; cursor: not-allowed; transform: none; }
        .btn-secondary {
            display: inline-flex; align-items: center; justify-content: center; gap: 0.5rem;
            padding: 0.75rem 1.5rem; background: transparent; color: var(--text-secondary);
            font-weight: 500; border: 1px solid var(--border-color); border-radius: 0.75rem;
            cursor: pointer; transition: all 0.3s ease;
        }
        .btn-secondary:hover { background: rgba(59, 130, 246, 0.1); color: white; }
        .progress-container { margin-bottom: 2rem; }
        .progress-text { display: flex; justify-content: space-between; margin-bottom: 0.5rem; font-size: 0.875rem; color: var(--text-secondary); }
        .progress-bar { height: 8px; background: rgba(59, 130, 246, 0.2); border-radius: 4px; overflow: hidden; }
        .progress-fill { height: 100%; background: linear-gradient(90deg, var(--primary-blue), var(--primary-purple)); border-radius: 4px; transition: width 0.5s ease; }
        .question-title { font-size: 1.5rem; font-weight: 700; margin-bottom: 1.5rem; line-height: 1.4; }
        @media (max-width: 640px) { .question-title { font-size: 1.25rem; } }
        .options-container { display: flex; flex-direction: column; gap: 0.75rem; margin-bottom: 2rem; }
        .option-btn {
            display: flex; align-items: center; gap: 1rem; width: 100%; padding: 1.25rem;
            background: rgba(59, 130, 246, 0.05); border: 2px solid transparent; border-radius: 0.75rem;
            color: var(--text-primary); font-size: 1rem; text-align: left; cursor: pointer; transition: all 0.3s ease;
        }
        .option-btn:hover { background: rgba(59, 130, 246, 0.1); border-color: rgba(59, 130, 246, 0.3); }
        .option-btn.selected { background: rgba(59, 130, 246, 0.15); border-color: var(--primary-blue); }
        .option-btn .radio-circle {
            width: 24px; height: 24px; border: 2px solid var(--border-color); border-radius: 50%;
            display: flex; align-items: center; justify-content: center; flex-shrink: 0; transition: all 0.3s ease;
        }
        .option-btn.selected .radio-circle { border-color: var(--primary-blue); background: var(--primary-blue); }
        .option-btn.selected .radio-circle::after { content: ''; width: 8px; height: 8px; background: white; border-radius: 50%; }
        .nav-buttons { display: flex; gap: 1rem; justify-content: space-between; }
        .nav-buttons .btn-secondary { flex: 0 0 auto; }
        .nav-buttons .btn-primary { flex: 1; }
        .processing-container { text-align: center; padding: 3rem 0; }
        .spinner {
            width: 80px; height: 80px; border: 4px solid rgba(59, 130, 246, 0.2);
            border-top-color: var(--primary-blue); border-radius: 50%;
            animation: spin 1s linear infinite; margin: 0 auto 2rem;
        }
        @keyframes spin { to { transform: rotate(360deg); } }
        .processing-text { font-size: 1.25rem; color: var(--text-secondary); }
        .processing-steps { margin-top: 1.5rem; text-align: left; max-width: 300px; margin-left: auto; margin-right: auto; }
        .processing-step { display: flex; align-items: center; gap: 0.75rem; padding: 0.5rem 0; color: var(--text-secondary); opacity: 0; animation: fadeIn 0.5s ease forwards; }
        .processing-step i { color: var(--green); }
        @keyframes fadeIn { to { opacity: 1; } }
        .results-header { text-align: center; margin-bottom: 2rem; }
        .score-container { position: relative; width: 220px; height: 140px; margin: 0 auto 1.5rem; }
        .score-value { position: absolute; bottom: 10px; left: 50%; transform: translateX(-50%); text-align: center; }
        .score-number { font-size: 3.5rem; font-weight: 800; line-height: 1; }
        .score-label { font-size: 0.875rem; color: var(--text-secondary); margin-top: 0.25rem; }
        .risk-badge { display: inline-flex; align-items: center; gap: 0.5rem; padding: 0.75rem 1.5rem; border-radius: 2rem; font-weight: 600; font-size: 1.125rem; margin-bottom: 1rem; }
        .risk-message { color: var(--text-secondary); font-size: 1rem; max-width: 500px; margin: 0 auto; line-height: 1.6; }
        .vulnerabilities-section { margin-top: 2rem; padding-top: 2rem; border-top: 1px solid var(--border-color); }
        .section-title { font-size: 1.25rem; font-weight: 700; margin-bottom: 1rem; display: flex; align-items: center; gap: 0.5rem; }
        .vulnerability-item {
            display: flex; align-items: flex-start; gap: 1rem; padding: 1rem;
            background: rgba(239, 68, 68, 0.05); border: 1px solid rgba(239, 68, 68, 0.2);
            border-radius: 0.75rem; margin-bottom: 0.75rem;
        }
        .vulnerability-item i { color: var(--red); font-size: 1.25rem; margin-top: 0.125rem; }
        .vulnerability-text { color: var(--text-secondary); font-size: 0.9375rem; line-height: 1.5; }
        .email-section { margin-top: 2rem; padding-top: 2rem; border-top: 1px solid var(--border-color); }
        .form-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 1rem; margin-bottom: 1.5rem; }
        @media (max-width: 640px) { .form-grid { grid-template-columns: 1fr; } }
        .form-group { display: flex; flex-direction: column; gap: 0.5rem; }
        .form-label { font-size: 0.875rem; font-weight: 500; color: var(--text-secondary); }
        .form-input {
            padding: 0.875rem 1rem; background: rgba(15, 23, 42, 0.9);
            border: 2px solid var(--border-color); border-radius: 0.5rem;
            color: white; font-size: 1rem; transition: all 0.3s ease;
        }
        .form-input:focus { outline: none; border-color: var(--primary-blue); box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1); }
        .form-input::placeholder { color: rgba(148, 163, 184, 0.5); }
        .thank-you { text-align: center; padding: 2rem 0; }
        .thank-you-icon { width: 80px; height: 80px; background: rgba(16, 185, 129, 0.1); border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 1.5rem; }
        .thank-you-icon i { font-size: 2.5rem; color: var(--green); }
        .thank-you h3 { font-size: 1.5rem; font-weight: 700; margin-bottom: 0.75rem; }
        .thank-you p { color: var(--text-secondary); margin-bottom: 1.5rem; }
        .footer { text-align: center; padding: 2rem 0; color: var(--text-secondary); font-size: 0.875rem; }
        .footer a { color: var(--primary-blue); text-decoration: none; }
        .footer a:hover { text-decoration: underline; }
        .hidden { display: none !important; }
        .fade-in { animation: fadeInUp 0.5s ease forwards; }
        @keyframes fadeInUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body>
    <div class="bg-pattern"></div>
    <div class="container">
        <header class="header">
            <a href="https://quantumshieldlabs.dev" class="logo">
                <i class="fas fa-shield-alt"></i>
                <span class="logo-text">Quantum Shield Labs</span>
            </a>
        </header>
        <main class="card">
            <section id="landing" class="fade-in">
                <h1 class="landing-title">Quantum Security <span>Risk Calculator</span></h1>
                <p class="landing-subtitle">Assess your organization's vulnerability to quantum computing threats in just 2 minutes. Get an instant risk score with actionable recommendations.</p>
                <div class="features-grid">
                    <div class="feature-item"><i class="fas fa-check-circle"></i><span>8 critical security questions</span></div>
                    <div class="feature-item"><i class="fas fa-check-circle"></i><span>Instant risk assessment</span></div>
                    <div class="feature-item"><i class="fas fa-check-circle"></i><span>Professional PDF report</span></div>
                    <div class="feature-item"><i class="fas fa-check-circle"></i><span>No credit card required</span></div>
                </div>
                <button class="btn-primary" onclick="startAssessment()">
                    <i class="fas fa-calculator"></i> Start Free Assessment <i class="fas fa-arrow-right"></i>
                </button>
                <p style="text-align: center; margin-top: 1rem; color: var(--text-secondary); font-size: 0.875rem;">Takes approximately 2 minutes</p>
            </section>
            <section id="assessment" class="hidden">
                <div class="progress-container">
                    <div class="progress-text">
                        <span>Question <span id="currentQuestion">1</span> of 8</span>
                        <span id="progressPercent">0%</span>
                    </div>
                    <div class="progress-bar"><div class="progress-fill" id="progressFill" style="width: 0%"></div></div>
                </div>
                <div id="questionContainer"></div>
                <div class="nav-buttons">
                    <button class="btn-secondary hidden" id="backBtn" onclick="previousQuestion()"><i class="fas fa-arrow-left"></i> Back</button>
                    <button class="btn-primary" id="nextBtn" onclick="nextQuestion()" disabled><span id="nextBtnText">Next</span> <i class="fas fa-arrow-right" id="nextBtnIcon"></i></button>
                </div>
            </section>
            <section id="processing" class="hidden">
                <div class="processing-container">
                    <div class="spinner"></div>
                    <p class="processing-text">Analyzing your responses...</p>
                    <div class="processing-steps">
                        <div class="processing-step" style="animation-delay: 0.3s"><i class="fas fa-check"></i><span>Evaluating cryptographic protocols</span></div>
                        <div class="processing-step" style="animation-delay: 0.8s"><i class="fas fa-check"></i><span>Assessing data retention risks</span></div>
                        <div class="processing-step" style="animation-delay: 1.3s"><i class="fas fa-check"></i><span>Calculating quantum vulnerability score</span></div>
                    </div>
                </div>
            </section>
            <section id="results" class="hidden">
                <div class="results-header">
                    <h2 style="font-size: 1.75rem; font-weight: 700; margin-bottom: 1.5rem;">Your Quantum Risk Assessment</h2>
                    <div class="score-container">
                        <canvas id="scoreGauge"></canvas>
                        <div class="score-value">
                            <div class="score-number" id="scoreNumber">0</div>
                            <div class="score-label">Risk Score</div>
                        </div>
                    </div>
                    <div class="risk-badge" id="riskBadge"><i class="fas fa-shield-alt"></i><span id="riskLevel">CALCULATING...</span></div>
                    <p class="risk-message" id="riskMessage"></p>
                </div>
                <div class="vulnerabilities-section">
                    <h3 class="section-title"><i class="fas fa-exclamation-triangle" style="color: var(--orange)"></i> Identified Vulnerabilities</h3>
                    <div id="vulnerabilitiesList"></div>
                </div>
                <div class="email-section" id="emailSection">
                    <h3 class="section-title"><i class="fas fa-file-pdf" style="color: var(--primary-blue)"></i> Get Your Detailed PDF Report</h3>
                    <p style="color: var(--text-secondary); margin-bottom: 1.5rem; font-size: 0.9375rem;">Enter your details to download a comprehensive report with personalized recommendations.</p>
                    <form id="emailForm" onsubmit="handleFormSubmit(event)">
                        <div class="form-grid">
                            <div class="form-group"><label class="form-label">Full Name *</label><input type="text" class="form-input" id="userName" name="name" placeholder="John Smith" required></div>
                            <div class="form-group"><label class="form-label">Company *</label><input type="text" class="form-input" id="userCompany" name="company" placeholder="Acme Healthcare" required></div>
                            <div class="form-group"><label class="form-label">Business Email *</label><input type="email" class="form-input" id="userEmail" name="email" placeholder="john@company.com" required></div>
                            <div class="form-group"><label class="form-label">Phone (Optional)</label><input type="tel" class="form-input" id="userPhone" name="phone" placeholder="(555) 123-4567"></div>
                        </div>
                        <input type="hidden" name="risk_score" id="hiddenScore">
                        <input type="hidden" name="risk_level" id="hiddenLevel">
                        <input type="hidden" name="assessment_data" id="hiddenData">
                        <button type="submit" class="btn-primary" id="downloadBtn"><i class="fas fa-download"></i> Download PDF Report</button>
                    </form>
                </div>
                <div id="thankYou" class="hidden">
                    <div class="thank-you">
                        <div class="thank-you-icon"><i class="fas fa-check"></i></div>
                        <h3>Report Downloaded!</h3>
                        <p>Your comprehensive quantum risk assessment report has been generated. Check your downloads folder.</p>
                        <a href="https://quantumshieldlabs.dev/#contact" class="btn-primary" style="max-width: 300px; margin: 0 auto;"><i class="fas fa-calendar-alt"></i> Schedule a Consultation</a>
                    </div>
                </div>
            </section>
        </main>
        <footer class="footer">
            <p>&copy; 2025 <a href="https://quantumshieldlabs.dev">Quantum Shield Labs</a>. All rights reserved.</p>
            <p style="margin-top: 0.5rem;">Protecting healthcare data in the quantum age.</p>
        </footer>
    </div>
    <script>
        const questions = [
            { id: 1, title: "What cryptographic protocols does your organization primarily use for data protection?", options: [
                { text: "RSA (2048-bit or 4096-bit)", points: 15 }, { text: "Elliptic Curve Cryptography (ECC)", points: 12 },
                { text: "Multiple protocols / Unsure", points: 10 }, { text: "AES (symmetric encryption only)", points: 5 }
            ]},
            { id: 2, title: "Where is encryption deployed in your environment?", options: [
                { text: "Unsure / Don't know", points: 15 }, { text: "Data at rest only", points: 8 },
                { text: "Data in transit only", points: 8 }, { text: "Both at rest and in transit", points: 5 }
            ]},
            { id: 3, title: "Do you store sensitive data that needs protection for 5+ years?", options: [
                { text: "Yes, we have long-term data retention requirements", points: 20 },
                { text: "Unsure about our retention policies", points: 10 }, { text: "No, most data is short-term", points: 5 }
            ]},
            { id: 4, title: "Which regulatory frameworks apply to your organization?", options: [
                { text: "Both HIPAA and HITECH", points: 15 }, { text: "HIPAA only", points: 10 },
                { text: "HITECH only", points: 10 }, { text: "Other regulations", points: 8 }, { text: "None / Not regulated", points: 5 }
            ]},
            { id: 5, title: "What type of sensitive data does your organization handle?", options: [
                { text: "Both PHI and financial data", points: 15 }, { text: "Protected Health Information (PHI)", points: 12 },
                { text: "Financial / payment data", points: 10 }, { text: "Other sensitive data", points: 8 }
            ]},
            { id: 6, title: "When was your last cryptographic security audit?", options: [
                { text: "Never conducted one", points: 20 }, { text: "More than 3 years ago", points: 15 },
                { text: "1-3 years ago", points: 8 }, { text: "Within the last year", points: 5 }
            ]},
            { id: 7, title: "How quickly could your organization migrate to new cryptographic standards?", options: [
                { text: "Unsure / No migration plan", points: 15 }, { text: "Would take 1-2 years", points: 12 },
                { text: "Could complete in 6-12 months", points: 8 }, { text: "Could complete in less than 6 months", points: 5 }
            ]},
            { id: 8, title: "What is the size of your organization?", options: [
                { text: "1,000+ employees", points: 15 }, { text: "201-1,000 employees", points: 12 },
                { text: "51-200 employees", points: 8 }, { text: "1-50 employees", points: 5 }
            ]}
        ];

        let currentQuestionIndex = 0, answers = {}, totalScore = 0;

        function startAssessment() {
            document.getElementById('landing').classList.add('hidden');
            document.getElementById('assessment').classList.remove('hidden');
            document.getElementById('assessment').classList.add('fade-in');
            renderQuestion();
        }

        function renderQuestion() {
            const q = questions[currentQuestionIndex], selected = answers[q.id];
            let html = q.options.map((o, i) => 
                `<button type="button" class="option-btn ${selected === i ? 'selected' : ''}" onclick="selectOption(${i}, ${o.points})">
                    <div class="radio-circle"></div><span>${o.text}</span>
                </button>`
            ).join('');
            document.getElementById('questionContainer').innerHTML = `<h2 class="question-title">${q.title}</h2><div class="options-container">${html}</div>`;
            const progress = (currentQuestionIndex / questions.length) * 100;
            document.getElementById('currentQuestion').textContent = currentQuestionIndex + 1;
            document.getElementById('progressPercent').textContent = Math.round(progress) + '%';
            document.getElementById('progressFill').style.width = progress + '%';
            document.getElementById('backBtn').classList.toggle('hidden', currentQuestionIndex === 0);
            document.getElementById('nextBtnText').textContent = currentQuestionIndex === questions.length - 1 ? 'See Results' : 'Next';
            document.getElementById('nextBtnIcon').className = currentQuestionIndex === questions.length - 1 ? 'fas fa-chart-bar' : 'fas fa-arrow-right';
            document.getElementById('nextBtn').disabled = selected === undefined;
        }

        function selectOption(index, points) {
            const q = questions[currentQuestionIndex];
            answers[q.id] = index;
            answers[q.id + '_points'] = points;
            answers[q.id + '_text'] = q.options[index].text;
            renderQuestion();
        }

        function nextQuestion() {
            if (answers[questions[currentQuestionIndex].id] === undefined) return;
            if (currentQuestionIndex < questions.length - 1) { currentQuestionIndex++; renderQuestion(); }
            else { showProcessing(); }
        }

        function previousQuestion() { if (currentQuestionIndex > 0) { currentQuestionIndex--; renderQuestion(); } }

        function showProcessing() {
            document.getElementById('assessment').classList.add('hidden');
            document.getElementById('processing').classList.remove('hidden');
            document.getElementById('processing').classList.add('fade-in');
            setTimeout(calculateResults, 2000);
        }

        function calculateResults() {
            totalScore = 0;
            for (let i = 1; i <= 8; i++) totalScore += answers[i + '_points'] || 0;
            document.getElementById('processing').classList.add('hidden');
            document.getElementById('results').classList.remove('hidden');
            document.getElementById('results').classList.add('fade-in');
            displayResults();
        }

        function displayResults() {
            let level, color, bgColor, icon, message;
            if (totalScore <= 25) { level = 'LOW RISK'; color = '#10b981'; bgColor = 'rgba(16,185,129,0.15)'; icon = 'fa-shield-alt'; message = 'Your organization shows a strong security posture. Continue monitoring quantum computing developments and review your cryptographic strategy annually.'; }
            else if (totalScore <= 50) { level = 'MODERATE RISK'; color = '#f59e0b'; bgColor = 'rgba(245,158,11,0.15)'; icon = 'fa-exclamation-circle'; message = 'Vulnerabilities detected in your current security framework. We recommend developing a post-quantum migration plan within the next 12 months.'; }
            else if (totalScore <= 75) { level = 'HIGH RISK'; color = '#f97316'; bgColor = 'rgba(249,115,22,0.15)'; icon = 'fa-exclamation-triangle'; message = 'Significant exposure to quantum threats identified. A comprehensive cryptographic assessment should be conducted within 3-6 months.'; }
            else { level = 'CRITICAL RISK'; color = '#ef4444'; bgColor = 'rgba(239,68,68,0.15)'; icon = 'fa-times-circle'; message = "Serious quantum vulnerability detected. Immediate action is required to protect your organization's sensitive data from current and future threats."; }
            
            const scoreNum = document.getElementById('scoreNumber');
            scoreNum.style.color = color;
            animateValue(scoreNum, 0, totalScore, 1000);
            const badge = document.getElementById('riskBadge');
            badge.style.background = bgColor; badge.style.color = color;
            badge.innerHTML = `<i class="fas ${icon}"></i><span>${level}</span>`;
            document.getElementById('riskMessage').textContent = message;
            document.getElementById('riskLevel').textContent = level;
            drawGauge(totalScore, color);
            displayVulnerabilities();
            document.getElementById('hiddenScore').value = totalScore;
            document.getElementById('hiddenLevel').value = level;
            document.getElementById('hiddenData').value = JSON.stringify(answers);
        }

        function animateValue(el, start, end, duration) {
            let startTime = null;
            const step = (ts) => {
                if (!startTime) startTime = ts;
                const progress = Math.min((ts - startTime) / duration, 1);
                el.textContent = Math.floor(progress * (end - start) + start);
                if (progress < 1) requestAnimationFrame(step);
            };
            requestAnimationFrame(step);
        }

        function drawGauge(score, color) {
            const ctx = document.getElementById('scoreGauge').getContext('2d');
            new Chart(ctx, {
                type: 'doughnut',
                data: { datasets: [{ data: [score, 100 - score], backgroundColor: [color, 'rgba(59,130,246,0.1)'], borderWidth: 0, circumference: 180, rotation: 270 }] },
                options: { responsive: true, maintainAspectRatio: false, cutout: '75%', plugins: { legend: { display: false }, tooltip: { enabled: false } }, animation: { animateRotate: true, duration: 1500 } }
            });
        }

        function displayVulnerabilities() {
            const vulns = [];
            if (answers['3_points'] === 20) vulns.push({ pts: 20, txt: "Long-term data storage vulnerable to 'harvest now, decrypt later' quantum attacks" });
            if (answers['6_points'] === 20) vulns.push({ pts: 20, txt: "No cryptographic security audits create dangerous blind spots to quantum threats" });
            if (answers['1_points'] === 15) vulns.push({ pts: 15, txt: "RSA encryption will be broken by quantum computers within 5-10 years" });
            if (answers['2_points'] === 15) vulns.push({ pts: 15, txt: "Unknown encryption deployment points create exploitable vulnerabilities" });
            if (answers['7_points'] === 15) vulns.push({ pts: 15, txt: "Inability to quickly migrate to quantum-resistant algorithms extends exposure window" });
            if (answers['8_points'] === 15) vulns.push({ pts: 15, txt: "Enterprise scale amplifies potential impact of quantum cryptographic breaks" });
            if (answers['4_points'] === 15) vulns.push({ pts: 15, txt: "Dual regulatory requirements (HIPAA/HITECH) face quantum compliance gaps" });
            if (answers['5_points'] === 15) vulns.push({ pts: 15, txt: "Combined PHI and financial data creates high-value quantum attack target" });
            vulns.sort((a, b) => b.pts - a.pts);
            const top3 = vulns.slice(0, 3);
            const container = document.getElementById('vulnerabilitiesList');
            if (top3.length === 0) {
                container.innerHTML = '<div class="vulnerability-item" style="background:rgba(16,185,129,0.05);border-color:rgba(16,185,129,0.2)"><i class="fas fa-check-circle" style="color:var(--green)"></i><span class="vulnerability-text">No critical vulnerabilities detected. Continue monitoring and maintain your security posture.</span></div>';
            } else {
                container.innerHTML = top3.map(v => `<div class="vulnerability-item"><i class="fas fa-exclamation-circle"></i><span class="vulnerability-text">${v.txt}</span></div>`).join('');
            }
        }

        async function handleFormSubmit(e) {
            e.preventDefault();
            const btn = document.getElementById('downloadBtn');
            btn.disabled = true;
            btn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Processing...';
            try {
                const form = document.getElementById('emailForm');
                const response = await fetch('https://formspree.io/f/mgvrkooo', { method: 'POST', body: new FormData(form), headers: { 'Accept': 'application/json' } });
                generatePDF();
                document.getElementById('emailSection').classList.add('hidden');
                document.getElementById('thankYou').classList.remove('hidden');
            } catch (err) {
                generatePDF();
                btn.disabled = false;
                btn.innerHTML = '<i class="fas fa-download"></i> Download PDF Report';
            }
        }

        function generatePDF() {
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();
            const company = document.getElementById('userCompany').value || 'Organization';
            const level = document.getElementById('hiddenLevel').value;
            let riskColor = totalScore <= 25 ? [16,185,129] : totalScore <= 50 ? [245,158,11] : totalScore <= 75 ? [249,115,22] : [239,68,68];

            // Page 1
            doc.setFillColor(15,23,42); doc.rect(0,0,210,40,'F');
            doc.setTextColor(59,130,246); doc.setFontSize(24); doc.setFont('helvetica','bold');
            doc.text('QUANTUM SHIELD LABS',105,20,{align:'center'});
            doc.setTextColor(148,163,184); doc.setFontSize(10); doc.setFont('helvetica','normal');
            doc.text('Post-Quantum Security Solutions for Healthcare',105,30,{align:'center'});
            doc.setTextColor(0,0,0); doc.setFontSize(20); doc.setFont('helvetica','bold');
            doc.text('Quantum Security Risk Assessment',105,60,{align:'center'});
            doc.setFontSize(11); doc.setFont('helvetica','normal'); doc.setTextColor(100,100,100);
            doc.text('Prepared for: '+company,105,72,{align:'center'});
            doc.text('Date: '+new Date().toLocaleDateString('en-US',{year:'numeric',month:'long',day:'numeric'}),105,80,{align:'center'});
            doc.setDrawColor(...riskColor); doc.setLineWidth(3); doc.circle(105,120,30);
            doc.setTextColor(...riskColor); doc.setFontSize(36); doc.setFont('helvetica','bold');
            doc.text(totalScore.toString(),105,125,{align:'center'});
            doc.setFontSize(10); doc.setTextColor(100,100,100); doc.text('Risk Score',105,135,{align:'center'});
            doc.setFillColor(...riskColor); doc.roundedRect(65,155,80,12,3,3,'F');
            doc.setTextColor(255,255,255); doc.setFontSize(12); doc.setFont('helvetica','bold');
            doc.text(level,105,163,{align:'center'});
            doc.setTextColor(60,60,60); doc.setFontSize(11); doc.setFont('helvetica','normal');
            const msg = document.getElementById('riskMessage').textContent;
            doc.text(doc.splitTextToSize(msg,150),105,185,{align:'center'});

            // Page 2
            doc.addPage();
            doc.setFillColor(15,23,42); doc.rect(0,0,210,20,'F');
            doc.setTextColor(59,130,246); doc.setFontSize(14); doc.setFont('helvetica','bold');
            doc.text('QUANTUM SHIELD LABS',105,13,{align:'center'});
            doc.setTextColor(0,0,0); doc.setFontSize(16); doc.text("Your Organization's Profile",20,40);
            doc.setDrawColor(59,130,246); doc.setLineWidth(0.5); doc.line(20,45,190,45);
            let y = 55; doc.setFontSize(10);
            questions.forEach((q,i) => {
                if(y>250){doc.addPage();y=30;}
                doc.setFont('helvetica','bold'); doc.setTextColor(60,60,60);
                const qt = doc.splitTextToSize('Q'+(i+1)+': '+q.title,170);
                doc.text(qt,20,y); y += qt.length*5+3;
                doc.setFont('helvetica','normal'); doc.setTextColor(59,130,246);
                doc.text('Answer: '+(answers[(i+1)+'_text']||'Not answered'),25,y); y+=12;
            });
            y+=10; if(y>220){doc.addPage();y=30;}
            doc.setTextColor(0,0,0); doc.setFontSize(16); doc.setFont('helvetica','bold');
            doc.text('Identified Vulnerabilities',20,y); y+=5;
            doc.setDrawColor(239,68,68); doc.line(20,y,190,y); y+=10;
            const vulnItems = document.querySelectorAll('#vulnerabilitiesList .vulnerability-text');
            doc.setFontSize(10); doc.setFont('helvetica','normal');
            vulnItems.forEach((item,i) => {
                if(y>270){doc.addPage();y=30;}
                doc.setTextColor(180,50,50); doc.text((i+1)+'.',20,y);
                doc.setTextColor(60,60,60);
                const vt = doc.splitTextToSize(item.textContent,160);
                doc.text(vt,28,y); y+=vt.length*5+8;
            });

            // Page 3
            doc.addPage();
            doc.setFillColor(15,23,42); doc.rect(0,0,210,20,'F');
            doc.setTextColor(59,130,246); doc.setFontSize(14); doc.setFont('helvetica','bold');
            doc.text('QUANTUM SHIELD LABS',105,13,{align:'center'});
            doc.setTextColor(0,0,0); doc.setFontSize(16); doc.text('Understanding Quantum Threats',20,40);
            doc.setDrawColor(59,130,246); doc.line(20,45,190,45);
            doc.setFontSize(10); doc.setFont('helvetica','normal'); doc.setTextColor(60,60,60);
            const threat = "Quantum computers pose an existential threat to current encryption methods. The 'harvest now, decrypt later' threat is particularly concerning for healthcare organizations. Adversaries are already collecting encrypted data with the intention of decrypting it once quantum computers become available.";
            doc.text(doc.splitTextToSize(threat,170),20,55);
            doc.setTextColor(0,0,0); doc.setFontSize(14); doc.setFont('helvetica','bold');
            doc.text('Why Act Now',20,95);
            doc.setFontSize(10); doc.setFont('helvetica','normal'); doc.setTextColor(60,60,60);
            const reasons = ['NIST has finalized post-quantum cryptography standards (FIPS 203, 204, 205)','Healthcare data has long-term value and retention requirements (50+ years)','Migration to quantum-resistant cryptography takes 2-5 years','Regulatory pressure is building—early adopters will have competitive advantages'];
            let ry = 105;
            reasons.forEach(r => { doc.setTextColor(59,130,246); doc.text('•',25,ry); doc.setTextColor(60,60,60); doc.text(r,32,ry); ry+=8; });
            doc.setTextColor(0,0,0); doc.setFontSize(14); doc.setFont('helvetica','bold');
            doc.text('Recommended Next Steps',20,150);
            doc.setFontSize(10); doc.setFont('helvetica','normal');
            const steps = ['Complete a comprehensive cryptographic inventory','Identify systems with longest data retention requirements','Assess vendor quantum readiness and migration timelines','Develop a post-quantum migration roadmap','Begin pilot implementations with non-critical systems'];
            let sy = 160;
            steps.forEach((s,i) => { doc.setTextColor(59,130,246); doc.text((i+1)+'.',25,sy); doc.setTextColor(60,60,60); doc.text(s,32,sy); sy+=8; });
            doc.setFillColor(240,245,255); doc.roundedRect(20,200,170,50,3,3,'F');
            doc.setTextColor(0,0,0); doc.setFontSize(12); doc.setFont('helvetica','bold');
            doc.text('Ready to Secure Your Organization?',105,215,{align:'center'});
            doc.setFontSize(10); doc.setFont('helvetica','normal'); doc.setTextColor(60,60,60);
            doc.text('Contact Quantum Shield Labs for a comprehensive assessment',105,225,{align:'center'});
            doc.setTextColor(59,130,246);
            doc.text('michael@quantumshieldlabs.dev | (240) 659-8286',105,235,{align:'center'});
            doc.text('6814 Westmoreland Ave, Takoma Park, MD 20912',105,243,{align:'center'});
            doc.setTextColor(150,150,150); doc.setFontSize(8);
            doc.text('© 2025 Quantum Shield Labs. All rights reserved.',105,280,{align:'center'});

            doc.save('Quantum_Risk_Assessment_'+company.replace(/[^a-zA-Z0-9]/g,'_')+'.pdf');
        }
    </script>
</body>
</html>
